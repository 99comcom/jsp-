<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    <style>
	form td{border: 1px solid gray;}
<style>
   form td {border:1px solid black;}
</style>    
<h1>상품등록</h1>
<form name="frm" method="post" enctype="multipart/form-data">
   <table>
      <tr>
         <td class="title" width=100>상품코드</td>
         <td width=100><input type="text" name="prod_id" size=5 value="${code}" readonly></td>
         <td class="title" width=100>제조원</td>
         <td width=300><input type="text" name="company" size=35></td>
         <td class="title" width=100>판매가격</td>
         <td width=100><input type="text" name="price1" size=8></td>
      </tr>
      <tr>
         <td class="title">업체코드</td>
         <td colspan=3><select name="mall_id" id="malls"></select></td>
         <td class="title">일반가격</td>
         <td><input type="text" name="price2" size=8></td>
      </tr>
      <tr>
         <td class="title">상품이름</td>
         <td colspan=5><input type="text" name="prod_name" size=100></td>
      </tr>
      <tr>
         <td class="title">상품이미지</td>
         <td colspan=5>
            <img src="https://dummyimage.com/150x150" id="image" width=150>
            <input type="file" name="image">
         </td>
      </tr>
      <tr>
         <td class="title">상품설명</td>
         <td colspan=5><textarea rows="10" cols="100" name="detail" placeholder="상품상세설명"></textarea></td>
      </tr>
   </table>
   <div class="buttons">
      <button>상품등록</button>
      <button type="reset">등록취소</button>
   </div>
</form>
<!-- 업체목록 템플릿 -->
<script id="temp" type="text/x-handlebars-template">
   {{#each array}}
   <option value="{{mall_id}}">{{mall_name}}({{mall_id}})</option>
   {{/each}}
</script>

<script>
   $("#image").on("click", function(){
      $(frm.image).click();
   });
   
   $(frm.image).on("change", function(e){
      var reader = new FileReader();
      reader.readAsDataURL(this.files[0]);
      reader.onload=function(e){ 
         $("#image").attr("src", e.target.result); 
      }
      
   });
   
   //업체목록출력
   $.ajax({
      type:"get",
      url:"/mall/list.json",
      data:{key:"mall_id",word:"",per:100,order:"mall_id",desc:"",page:1},
      dataType:"json",
      success:function(data){
         var temp=Handlebars.compile($("#temp").html());
         $("#malls").html(temp(data));
      }
   });
</script>